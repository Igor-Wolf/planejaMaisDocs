openapi: 3.0.0
info:
  title: Paneja+
  
  description: Projeto de gerenciamento de despesas e gastos
  version: 1.0.0

servers:
  - url: https://planeja-mais-backend.vercel.app/api

paths:
  /login/myAccount:
    get:
      summary: Informações do Usuário
      tags:
        - Usuários
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
      responses:
        "200":
          description: Informações retornadas com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  _id:
                    type: string
                  name:
                    type: string
                  user:
                    type: string
                  email:
                    type: string
                  lastEmail:
                    type: string
                  birthday:
                    type: string
                    format: date-time
                    example: "2025-01-08T12:00:00.000Z"
                  passwordHash:
                    type: string
                  createdAt:
                    type: string
                    format: date-time
                    example: "2025-01-21T23:02:54.937Z"
                  updatedAt:
                    type: string
                    format: date-time
                    example: "2025-01-21T23:02:54.937Z"
                  isActive:
                    type: boolean
        "400":
          description: "Erro"
  /login/protected:
    get:
      summary: Teste de token opcional
      tags:
        - Usuários
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
      responses:
        "200":
          description: Token foi confimado, e usuário liberado
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    type: string
                  yat:
                    type: number
                  exp:
                    type: number
        "400":
          description: "Erro"
  /login/autenticateAccountEmail:
    get:
      summary: Autenticar a conta do usuário
      tags:
        - Usuários
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
      responses:
        "200":
          description: Retorna uma mensagem de sucesso
          content:
            application/json:
              schema:
                type: string
        "400":
          description: "Erro"
  /login/forgotPassword/{email}:
    get:
      summary: Recuperar senha
      tags:
        - Usuários
      parameters:
        - name: email
          in: path
          required: true
          description: Dispara o email de recuperação de senha
          schema:
            type: string
      responses:
        "200":
          description: Retorna uma mensagem de sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "400":
          description: "Erro"

  /login/create:
    post:
      summary: Criar um  novo usuário
      tags:
        - Usuários
      description: Cria o usuário no banco. Criar com isActive false vai bloquear o login até o usuário autenticar por email
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - user
                - email
                - lastEmail
                - birthday
                - passwordHash
                - createdAt
                - updatedAt
                - isActive
              properties:
                name:
                  type: string
                user:
                  type: string
                email:
                  type: string
                lastEmail:
                  type: string
                birthday:
                  type: string
                  format: date-time
                  example: "2025-01-08T12:00:00.000Z"
                passwordHash:
                  type: string
                createdAt:
                  type: string
                  format: date-time
                  example: "2025-01-21T23:02:54.937Z"
                updatedAt:
                  type: string
                  format: date-time
                  example: "2025-01-21T23:02:54.937Z"
                isActive:
                  type: boolean

      responses:
        "200":
          description: Retorna uma mensagem de sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "409":
          description: "Conflito, usuário ou email já cadastrados no banco"
  /login/autentication:
    post:
      summary: Realizar o login
      tags:
        - Usuários
      description: Realizar o login e gerar o token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user
                - passwordHash
                - remember
              properties:
                user:
                  type: string
                passwordHash:
                  type: string
                remember:
                  type: boolean

      responses:
        "200":
          description: Retorna o token com autorização
          content:
            application/json:
              schema:
                type: string
        "401":
          description: "Acesso não autorizado"
        "409":
          description: "Conflito, usuário precisa autenticar a conta por email"
  /login/newPassword:
    post:
      summary: Alterar a senha do usuário
      tags:
        - Usuários
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
      description: Altera a senha do usuário no banco
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user
                - passwordHash
              properties:
                user:
                  type: string
                passwordHash:
                  type: string

      responses:
        "200":
          description: Senha alterada
          content:
            application/json:
              schema:
                type: string
        "400":
          description: "Erro"
  /login/update:
    patch:
      summary: Altera os dados do usuário
      tags:
        - Usuários
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
      description: Altera os dados do usuário usuário. Parâmetro user nunca poderá ser alterado. Retornar todas as informações, mesmo se não forem alteradas.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - user
                - email
                - lastEmail
                - birthday
                - passwordHash
                - createdAt
                - updatedAt
                - isActive
              properties:
                name:
                  type: string
                user:
                  type: string
                email:
                  type: string
                lastEmail:
                  type: string
                birthday:
                  type: string
                  format: date-time
                  example: "2025-01-08T12:00:00.000Z"
                passwordHash:
                  type: string
                createdAt:
                  type: string
                  format: date-time
                  example: "2025-01-21T23:02:54.937Z"
                updatedAt:
                  type: string
                  format: date-time
                  example: "2025-01-21T23:02:54.937Z"
                isActive:
                  type: boolean

      responses:
        "200":
          description: Retorna uma mensagem de sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "400":
          description: "Erro"
        "409":
          description: "Conflito no banco de dados"
  /login/delete:
    delete:
      summary: Deleta um usuário
      tags:
        - Usuários
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"

      responses:
        "200":
          description: Retorna uma mensagem de sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "400":
          description: "Erro"        
  /goal/myGoal/{year}/{month}:
    get:
      summary: Metas definidas
      tags:
        - Metas
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
        - name: year
          in: path
          required: true
          description: Filtro do ano desejado
          schema:
            type: string
        - name: month
          in: path
          required: true
          description: Filtro do mês desejado
          schema:
            type: string
      responses:
        "200":
          description: Informações retornadas com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  _id:
                    type: string
                  month:
                    type: number
                  year:
                    type: number
                  goal:
                    type: number
                  updatedAt:
                    type: string
                    format: date-time
                    example: "2025-01-21T23:02:54.937Z"
                  user:
                    type: string
        "400":
          description: "Erro"
  /goal/create:
    post:
      summary: Criar uma nova meta
      tags:
        - Metas
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
      description: Cria novas metas, é possivel criar uma meta anual definindo o mês referente como 0, os demais seguem o padrão YYYY-MM. Criar valores de mês como 1, 2, 3 ao invés de 01, 02, 03. O programa aceita valores positivos e negativos, no entanto não mandar +1.50, mandar apenas 1.50 nos positivos.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - month
                - year
                - goal
                - updatedAt
              properties:
                month:
                  type: number
                year:
                  type: number
                goal:
                  type: number
                updatedAt:
                  type: string
                  format: date-time
                  example: "2025-01-21T23:02:54.937Z"
      responses:
        "201":
          description: Retorna uma mensagem de sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "400":
          description: "Erro na requisição ou no formato dos dados"
        "409":
          description: "Conflito, meta referente ao mês/ano já cadastrada"
  /goal/update:
    patch:
      summary: Alterar a meta definida
      tags:
        - Metas
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
      description: Altera novas metas, é possivel alterar uma meta anual definindo o mês referente como 0, os demais seguem o padrão YYYY-MM. Criar valores de mês como 1, 2, 3 ao invés de 01, 02, 03. O programa aceita valores positivos e negativos, no entanto não mandar +1.50, mandar apenas 1.50 nos positivos.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - month
                - year
                - goal
                - updatedAt
              properties:
                month:
                  type: number
                year:
                  type: number
                goal:
                  type: number
                updatedAt:
                  type: string
                  format: date-time
                  example: "2025-01-21T23:02:54.937Z"
      responses:
        "200":
          description: Retorna uma mensagem de sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "400":
          description: "Erro na requisição ou na estrutura dos dados"
  /goal/delete/{year}/{month}:
    delete:
      summary: Deleta uma meta
      tags:
        - Metas
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
        - name: year
          in: path
          required: true
          description: Filtro do ano desejado
          schema:
            type: string
        - name: month
          in: path
          required: true
          description: Filtro do mês desejado
          schema:
            type: string

      responses:
        "200":
          description: Retorna uma mensagem de sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "400":
          description: "Erro"        
  /expense/myExpenseById/{_id}:
    get:
      summary: Lançamentos por ID
      tags:
        - Lançamentos      
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
        - name: _id
          in: path
          required: true
          description: Filtro pelo _id
          schema:
            type: string
      responses:
        "200":
          description: Informações retornadas com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  _id:
                    type: string
                  description:
                    type: string
                  value:
                    type: number
                  category:
                    type: string
                  date:
                    type: string
                    format: date-time
                    example: "2025-01-08T12:00:00.000Z"
                  updatedAt:
                    type: string
                    format: date-time
                    example: "2025-01-21T23:02:54.937Z"
                  user:
                    type: string
        "400":
          description: "Erro na requisição ou na estrutura dos dados"  
  /expense/myExpenseByDescription/{description}:
    get:
      summary: Lançamentos por descrição
      tags:
        - Lançamentos
      description: Retorna uma lista de lançamentos que contenha a descrição
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
        - name: description
          in: path
          required: true
          description: Filtro pela descrição, filtro que contenha a descrição, não sendo necessário ser exatamente igual
          schema:
            type: string
      responses:
        "200":
          description: Informações retornadas com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    _id:
                      type: string
                    description:
                      type: string
                    value:
                      type: number
                    category:
                      type: string
                    date:
                      type: string
                      format: date-time
                      example: "2025-01-08T12:00:00.000Z"
                    updatedAt:
                      type: string
                      format: date-time
                      example: "2025-01-21T23:02:54.937Z"
                    user:
                      type: string
        "400":
          description: "Erro na requisição ou na estrutura dos dados"  
  /expense/myExpenseByCategory/{category}:
    get:
      summary: Lançamentos por categoria
      tags:
        - Lançamentos
      description: Retorna uma lista de lançamentos que contenha a categoria
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
        - name: category
          in: path
          required: true
          description: Filtro pela categoria, categoria que contenha o valor, não necessário ser exatamente igual
          schema:
            type: string
      responses:
        "200":
          description: Informações retornadas com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    _id:
                      type: string
                    description:
                      type: string
                    value:
                      type: number
                    category:
                      type: string
                    date:
                      type: string
                      format: date-time
                      example: "2025-01-08T12:00:00.000Z"
                    updatedAt:
                      type: string
                      format: date-time
                      example: "2025-01-21T23:02:54.937Z"
                    user:
                      type: string
        "400":
          description: "Erro na requisição ou na estrutura dos dados"  
        
  /expense/myExpenseByDate/{date}:
    get:
      summary: Lançamentos por data
      tags:
        - Lançamentos
      description: Retorna uma lista de lançamentos que contenha a data, sendo apenas ano YYYY, mês YYYY-MM, ou dia YYYY-MM-dd
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
        - name: date
          in: path
          required: true
          description: Filtro pela data
          schema:
            type: string
            example: 2025, 2025-01, 2025-01-25
      responses:
        "200":
          description: Informações retornadas com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    _id:
                      type: string
                    description:
                      type: string
                    value:
                      type: number
                    category:
                      type: string
                    date:
                      type: string
                      format: date-time
                      example: "2025-01-08T12:00:00.000Z"
                    updatedAt:
                      type: string
                      format: date-time
                      example: "2025-01-21T23:02:54.937Z"
                    user:
                      type: string
        "400":
          description: "Erro na requisição ou na estrutura dos dados"  
  /expense/myExpenseAll:
    get:
      summary: Todos os lançamentos
      tags:
        - Lançamentos
      description: Retorna uma lista de todos os lançamentos com paginação a ser definida
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
        - name: skip
          in: path
          required: false
          description: Numero de itens que serão pulados
          schema:
            type: number
            example: 20, 5, 0
        - name: limit
          in: path
          required: false
          description: Numero máximo de itens que serão retornados na requisição
          schema:
            type: number
            example: 20, 5, 0
        - name: order
          in: path
          required: false
          description: Ordenação do retorno 
          schema:
            type: number
            example: asc ou desc
      responses:
        "200":
          description: Informações retornadas com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    _id:
                      type: string
                    description:
                      type: string
                    value:
                      type: number
                    category:
                      type: string
                    date:
                      type: string
                      format: date-time
                      example: "2025-01-08T12:00:00.000Z"
                    updatedAt:
                      type: string
                      format: date-time
                      example: "2025-01-21T23:02:54.937Z"
                    user:
                      type: string
        "400":
          description: "Erro na requisição ou na estrutura dos dados"  
  /expense/create:
      post:
        summary: Criar um novo lançamento
        tags:
          - Lançamentos
        parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
        description: Cria lançamentos. O sistema aceita valores positivos e negativos, no entanto mandar 1.50 ao invés de +1.50.
        requestBody:
          required: true
          content:
            application/json:
              schema:
                type: object
                required:
                  - description
                  - value
                  - category
                  - date
                  - updatedAt
                properties:
                  description:
                    type: string
                  value:
                    type: number
                  category:
                    type: string
                  date:
                      type: string
                      format: date-time
                      example: "2025-01-08T12:00:00.000Z"
                  updatedAt:
                    type: string
                    format: date-time
                    example: "2025-01-21T23:02:54.937Z"
        responses:
          "201":
            description: Retorna uma mensagem de sucesso
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    message:
                      type: string
                    _id:
                      type: string
          "400":
            description: "Erro na requisição ou no formato dos dados"
  /expense/update/{_id}:
    patch:
      summary: Alterar o lançamento definido
      tags:
        - Lançamentos
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
        - name: _id
          in: path
          required: true
          description: Filtra pelo _id
          schema:
            type: string
      description: Altera o lançamento definido
      requestBody:
        required: true
        content:
            application/json:
              schema:
                type: object
                required:
                  - description
                  - value
                  - category
                  - date
                  - updatedAt
                properties:
                  description:
                    type: string
                  value:
                    type: number
                  category:
                    type: string
                  date:
                      type: string
                      format: date-time
                      example: "2025-01-08T12:00:00.000Z"
                  updatedAt:
                    type: string
                    format: date-time
                    example: "2025-01-21T23:02:54.937Z"
      responses:
        "200":
          description: Retorna uma mensagem de sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "400":
          description: "Erro na requisição ou na estrutura dos dados"
  /expense/delete/{_id}:
    delete:
      summary: Deleta um lançamento
      tags:
        - Lançamentos
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"
        - name: _id
          in: path
          required: true
          description: Filtra pelo _id
          schema:
            type: string
      responses:
        "200":
          description: Retorna uma mensagem de sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "400":
          description: "Erro na requisição ou na estrutura dos dados"       
  /operation/allValues:
    get:
      summary: Somatório de todos os lançamentos
      tags:
        - Operações      
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"        
      responses:
        "200":
          description: Informações retornadas com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  value:
                    type: number                  
        "400":
          description: "Erro na requisição ou na estrutura dos dados"  
  /operation/allDateValues/{date}:
    get:
      summary: Somatório de todos os lançamentos por data
      tags:
        - Operações      
      parameters:
        - name: authorization
          in: header
          required: true
          description: O token do usuário
          schema:
            type: string
            example: "Bearer asldfkasjdlfjasdlfasjdflasdjfçlsaalsdkjf"  
        - name: date
          in: path
          required: true
          description: Filtro pela data
          schema:
            type: string
            example: 2025, 2025-01, 2025-01-25      
      responses:
        "200":
          description: Informações retornadas com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  value:
                    type: number                  
        "400":
          description: "Erro na requisição ou na estrutura dos dados"  